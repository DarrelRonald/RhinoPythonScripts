# RhinoPython and ghPyton Scripts
Scripts for use in Rhino 3D and Grasshopper. These are public scripts that can perhaps be of use in day-to-day projects and learning. 

What has been especially frustrating for me when learning scripting within the context of Rhino3D and Grasshopper3D is the many different ways to do the same things. For example, you can create the same script functionality in Python by using `scriptcontext` versus `RhinoCommon` versus `rhinoscriptcontext`. This flexibility is both good and bad, because it simplifies some things, but creates confusion around what is the best method to write scripts. In addition, each of the methods has pros/cons that need workarounds. For example, the `rhinoscriptsyntax` is simpler for writing scripts, but the API is incomplete. 

Further frustrating in the learning process is about understanding and using the `.NET` framework, `IronPython` and how to work with `.NET Assemblies`. The Microsoft documentation is very difficult to understand, there are many different versions of `.NET` and McNeel doesn't offer any guides or overviews (that I know of) to work with these libraries. 

For many of the ghPython scripts we only need proedural programming, but the class-oriented and object-oriented programming of the .NET environment and the McNeel [Rhino Developer Examples](https://github.com/mcneel/rhino-developer-samples/tree/5c8ac43e6d679125f08b5713ff1ac311819acd49) make learning more confusing for non-professional coders.

## Learning Scripts/Components
* __Add-Delete-Circle.py__ (includes: .py): this is a modification of the `add-circle.py` code of McNeel to see the 2 different methods of writing the `circle()` class and also to compare 2 ways to delete objects within the Rhino3D file using either `scriptcontext` versus `RhinoCommon` versus `rhinoscriptcontext`. One very good article I found after all this exploration was by [Danil Nagy](https://medium.com/generative-design/working-with-geometry-in-python-a256de7bb1b1)-however, the one mistake he makes is writing `Rhino.Geometry` instead of the correct `Rhino` library. `Rhino.Geometry` only gives you access to that specific Geometry Namespace.
* __Dir-Help.py__ (includes: .py): this is an example of how to use the builtin python functions `dir()` and `help()` when learning about new Python or RhinoPython modules while you're writing scripts. It can be used in your IDE as an alternative to looking up the API documentation online, which in some cases doesn't exist.
* __GetIronPythonModules.py__ (includdes: .py, .gh): This allows you to see all importable modules as well as a selected `sys.path` directory because sometimes the Rhino Python Editor Intellisense doesn't recognize all the IronPython modules. This allows you to see what Rhino will recognize. Thanks to [Anders Deleuran](https://discourse.mcneel.com/u/AndersDeleuran) for helping me with this on this [McNeel Discourse thread](https://discourse.mcneel.com/t/importing-ironpython-libraries/100288).

## Utility Scripts/Components
* __PythonTemplate_0.1.0__ (includes: .py): This python script has the most important python template elements.
* __ListOfRhinoCommands__ (includes: .py, .gh): this sorts a list of all `Rhino.Commands` that can be accessed through RhinoCommon. It is a tool for seeing quickly what commands are available. You can also copy the output panel contents and paste into an excel sheet.
* __ImportSysExplorer_0.1.0__ (includes: .gh): This ghPython module imports the sys module from IronPython and exports to panels both `sys.builtin_module_names` and the `sys.path`.
* __ScriptContextChanger__ (includes different: .py, .gh): these are more educational code blocks. However, if you're writing python scripts using RhinoCommon, you will sometimes need to change the `scriptcontext.doc`

# Tips & Tricks
Below are some things that I've noticed along the way, read up on the [McNeel Discourse Forum](https://discourse.mcneel.com/) and know that others will probably find these same challenges, bugs or frustrations. __Feel free to fork and propose changes__.

1. __Rhino Dev Docs General Guides__: Rhino Dev Docs has a somewhat hidden but very helpful set of [General Guides](https://developer.rhino3d.com/guides/general/). Some valuable articles are: [Rhino Technology Overview](https://developer.rhino3d.com/guides/general/rhino-technology-overview/) and [Developer Preprequisites](https://developer.rhino3d.com/guides/general/rhino-developer-prerequisites/) among others  
1. __Rhino Python Intellisense__: In a Python script, sometimes the builtin Rhino Python Editor (both Rhino and Grasshopper) won't recognize the full set of IronPython modules. Other people also had this problem. You can `import` the modules you want, and intellisense should start working after it has been imported. I had this problem on Window 10, Rhino v6 SR 24. In the above __Learning__ section you will see the script `GetIronPythonModules.py` you can see the full list of importable modules from Rhino Python.
1. __Rhino Python IDE with PyCharm__: [Steve Baer has an article](https://stevebaer.wordpress.com/2019/02/25/autocomplete-and-type-hints-with-python-scripts-for-rhino-grasshopper/) explaining how to use [PyCharm](https://www.jetbrains.com/pycharm/) with intellisense stubs for RhinoCommon and Grasshopper.
1. __Python Imports__: Here is a [Definitive Guide to Python Imports](https://chrisyeh96.github.io/2017/08/08/definitive-guide-python-imports.html) by Chris Yeh.
1. __Using Grasshoppers builtin Loop functionality in ghPython__: Grasshopper does automatic iteration in the ghPython component. This means that if you create your own loops, you might encounter bugs. Alternatively, as [Giulio Piacentino writes](https://discourse.mcneel.com/t/puzzled-by-iteration-in-gh-python-components/2538/6?u=d.ronald), you can write your python script as though you're operating on 1 item; Grasshopper will handle all the loop iterations behind the scenes. Guiulio also [references this thread](https://www.grasshopper3d.com/forum/topics/removing-gh-components-intelligence?commentId=2985220%3AComment%3A963369) for more explanation.
1. __Compiling ghPython Scripts__: Here is a thread by [Giulio Piacentino](https://discourse.mcneel.com/t/tutorial-creating-a-grasshopper-component-with-the-python-ghpy-compiler/38552) about how to __Create a Grasshopper Component__ using the Python GHPY compiler. There are two guides: (A) Single Component, and (B) Multiple components exports.
1. __GHPython Data Tree Helpers__: McNeel has provided two [Data Tree helpers for GHPython](https://developer.rhino3d.com/guides/rhinopython/grasshopper-datatrees-and-python/) that are very important once you figure out how to use them. The 2 functions can be added to a python script with `import ghpythonlib.treehelpers`. One command will construct a Data Tree from a List or Nested List. The second command will deconstruct a Data Tree to a List or Nested List. You can see the functions on [Github here](https://gist.github.com/piac/ef91ac83cb5ee92a1294).
1. __Breps versus Meshes__: I recently refactored my python code to test using `meshes` instead of `breps` to speed up the functions in the code. I was doing boolean operations, testing for inclusions and creating contours. While using breps, the script was running for 5.1 seconds. Once I refactored to using Meshes, the scripts ran at 384 milliseconds, about 8% of the time.
1. __Object Oriented Design__: [Python OOP Tutorials](https://www.youtube.com/playlist?list=PL-osiE80TeTsqhIuOqKhwlXsIBIdSeYtc) is a set of 6 free videos by Corey Schafer on Youtube is a fantastic source for understanding how to write OOP code with Python. It is concise, quick-paced and goes into deeper topics of how Python handles classes and inhertance among other topics.
